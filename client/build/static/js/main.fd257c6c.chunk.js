(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{233:function(e,t,n){},235:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(82),s=n.n(a),c=n(14),o=n(27),i=n(207),j=n(17),l=n(67),u=n(200),b=n(3),d="MEGNET_CHAT_TOKEN",O={user:null},m=localStorage.getItem(d);if(m){var p=Object(u.a)(m);1e3*p.exp<Date.now()?localStorage.removeItem(d):O.user=p}var h,x,g,f,v,I,y,C,N,k="LOGIN",w="LOGOUT",S=Object(r.createContext)({user:null,login:function(){},logout:function(){}}),P=function(){return Object(r.useContext)(S)},$=function(e,t){switch(t.type){case k:return Object(l.a)(Object(l.a)({},e),{},{user:t.payload});case w:return Object(l.a)(Object(l.a)({},e),{},{user:null});default:return e}},E=function(e){var t=e.children,n=Object(r.useReducer)($,O),a=Object(j.a)(n,2),s=a[0],c=a[1],o={user:s.user,login:function(e){localStorage.setItem(d,e.token),c({type:k,payload:e})},logout:function(){localStorage.removeItem(d),c({type:w})}};return Object(b.jsx)(S.Provider,{value:o,children:t})},A=n(19),L=n(251),q=n(260),D=n(255),M=n(89),Q=n.n(M),R=n(257),H=n(252),U=n(205),z=n(258),T=n(114),G=n(157),_=n(58),B=Object(c.gql)(h||(h=Object(_.a)(["\n  {\n    posts: getposts {\n      id\n      body\n      userName\n      createdAt\n      comments {\n        body\n        createdAt\n        userName\n      }\n      commentCount\n      likes {\n        userName\n      }\n      likeCount\n    }\n  }\n"]))),F=Object(c.gql)(x||(x=Object(_.a)(["\n  mutation registerUser(\n    $userName: String!\n    $email: String!\n    $password: String!\n    $confirmPassword: String!\n  ) {\n    registerUser(\n      userInput: {\n        userName: $userName\n        email: $email\n        password: $password\n        confirmPassword: $confirmPassword\n      }\n    ) {\n      id\n      email\n      userName\n      createdAt\n      token\n    }\n  }\n"]))),V=Object(c.gql)(g||(g=Object(_.a)(["\n  mutation userLogin($userName: String!, $password: String!) {\n    userLogin(userName: $userName, password: $password) {\n      id\n      email\n      userName\n      token\n    }\n  }\n"]))),J=Object(c.gql)(f||(f=Object(_.a)(["\n  mutation createPost($body: String!) {\n    createPost(body: $body) {\n      id\n      userName\n      createdAt\n      body\n      likes {\n        id\n        userName\n        createdAt\n      }\n      likeCount\n      comments {\n        id\n        body\n        userName\n        createdAt\n      }\n      commentCount\n    }\n  }\n"]))),K=Object(c.gql)(v||(v=Object(_.a)(["\n  mutation likePost($postId: ID!) {\n    likePost(postId: $postId) {\n      id\n      likes {\n        id\n        userName\n      }\n      likeCount\n    }\n  }\n"]))),W=Object(c.gql)(I||(I=Object(_.a)(["\n  query getPost($postId: ID!) {\n    getPost(postId: $postId) {\n      id\n      body\n      userName\n      likeCount\n      likes {\n        userName\n      }\n      comments {\n        id\n        userName\n        createdAt\n        body\n      }\n      commentCount\n    }\n  }\n"]))),X=Object(c.gql)(y||(y=Object(_.a)(["\n  mutation deletePost($postId: ID!) {\n    deletePost(postId: $postId)\n  }\n"]))),Y=Object(c.gql)(C||(C=Object(_.a)(["\n  mutation deleteComment($postId: ID!, $commentId: ID!) {\n    deleteComment(postId: $postId, commentId: $commentId) {\n      id\n      comments {\n        id\n        userName\n        createdAt\n      }\n      commentCount\n    }\n  }\n"]))),Z=Object(c.gql)(N||(N=Object(_.a)(["\n  mutation createComment($postId: ID!, $body: String!) {\n    createComment(postId: $postId, body: $body) {\n      id\n      comments {\n        id\n        userName\n        body\n        createdAt\n      }\n      commentCount\n    }\n  }\n"])));var ee=function(e){var t=e.post,n=t.likes,a=t.likeCount,s=t.id,i=e.user,l=Object(r.useState)(!1),u=Object(j.a)(l,2),d=u[0],O=u[1],m=(Object(A.g)(),Object(c.useMutation)(K,{variables:{postId:s}})),p=Object(j.a)(m,1)[0];Object(r.useEffect)((function(){i&&n.find((function(e){return e.userName===i.userName}))?O(!0):O(!1)}),[i,n]);var h=i?d?Object(b.jsx)(z.a,{color:"pink",children:Object(b.jsx)(T.a,{name:"heart"})}):Object(b.jsx)(z.a,{basic:!0,color:"pink",children:Object(b.jsx)(T.a,{name:"heart"})}):Object(b.jsx)(z.a,{basic:!0,color:"pink",to:"/login",as:o.b,children:Object(b.jsx)(T.a,{name:"heart"})});return Object(b.jsx)(H.a,{content:d?"Unlike":"Like",inverted:!0,trigger:Object(b.jsxs)(z.a,{as:"div",labelPosition:"right",onClick:i&&p,children:[h,Object(b.jsx)(G.a,{basic:!0,color:"pink",pointing:"left",children:a})]})})},te=n(256);var ne=function(e){var t=e.postId,n=e.cb,a=e.commentId,s=Object(r.useState)(!1),o=Object(j.a)(s,2),i=o[0],l=o[1],u=a?Y:X,d=Object(c.useMutation)(u,{update:function(e){if(l(!1),!a){var r=e.readQuery({query:B}).posts.filter((function(e){return e.id!==t}));e.writeQuery({query:B,data:{posts:r}})}n&&n()},variables:{postId:t,commentId:a}}),O=Object(j.a)(d,1)[0];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(z.a,{as:"div",floated:"right",color:"red",onClick:function(){return l(!0)},children:Object(b.jsx)(T.a,{name:"trash",style:{margin:"0"}})}),Object(b.jsx)(te.a,{size:"mini",open:i,onCancel:function(){return l(!1)},onConfirm:O})]})};function re(e){var t=e.post,n=t.id,r=t.userName,a=t.likes,s=t.likeCount,c=t.commentCount,i=t.createdAt,j=t.body,l=P().user;return Object(b.jsxs)(R.a,{fluid:!0,children:[Object(b.jsxs)(R.a.Content,{children:[Object(b.jsx)(H.a,{inverted:!0,content:r,trigger:Object(b.jsx)(U.a,{floated:"right",size:"mini",src:"https://react.semantic-ui.com/images/avatar/large/molly.png"})}),Object(b.jsx)(R.a.Header,{as:o.b,to:"/posts/".concat(n),children:r}),Object(b.jsx)(R.a.Meta,{children:Q()(i).fromNow()}),Object(b.jsx)(R.a.Description,{children:j})]}),Object(b.jsx)(R.a.Content,{extra:!0,children:Object(b.jsxs)("div",{children:[Object(b.jsx)(ee,{user:l,post:{likes:a,likeCount:s,id:n}}),Object(b.jsx)(H.a,{inverted:!0,content:"Comment on Post",trigger:Object(b.jsxs)(z.a,{as:o.b,labelPosition:"right",to:"/posts/".concat(n),children:[Object(b.jsx)(z.a,{basic:!0,color:"teal",children:Object(b.jsx)(T.a,{name:"comments"})}),Object(b.jsx)(G.a,{basic:!0,color:"teal",pointing:"left",children:c})]})}),l&&l.userName===r&&Object(b.jsx)(ne,{postId:n})]})})]})}var ae=n(206),se=n(253);function ce(){var e=Object(r.useState)(""),t=Object(j.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(""),o=Object(j.a)(s,2),i=o[0],l=o[1],u=Object(c.useMutation)(J,{variables:{body:n},update:function(e,t){var n=e.readQuery({query:B});e.writeQuery({query:B,data:{posts:[t.data.createPost].concat(Object(ae.a)(n.posts))}})},onError:function(e){l(e.graphQLErrors[0].message)}}),d=Object(j.a)(u,1)[0];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(se.a,{onSubmit:function(e){e.preventDefault(),d(),a("")},children:[Object(b.jsx)("h2",{children:"Create a Post"}),Object(b.jsxs)(se.a.Field,{children:[Object(b.jsx)(se.a.Input,{placeholder:"Say Hello...",type:"text",value:n,onChange:function(e){return a(e.target.value)},error:!!i}),Object(b.jsx)(z.a,{type:"submit",color:"pink",children:"Post"})]})]}),i&&Object(b.jsx)("div",{className:"ui error message",children:Object(b.jsx)("ul",{className:"list",children:Object(b.jsx)("li",{children:i})})})]})}var oe=function(){var e=P().user,t=Object(c.useQuery)(B),n=t.data,r=(n=void 0===n?{}:n).posts,a=t.loading;return Object(b.jsxs)(q.a,{columns:"2",className:"posts",children:[Object(b.jsx)(q.a.Row,{children:Object(b.jsx)("h1",{children:"Recent Posts"})}),e&&Object(b.jsx)(q.a.Row,{children:Object(b.jsx)(q.a.Column,{children:Object(b.jsx)(ce,{})})}),Object(b.jsx)(q.a.Row,{children:a?Object(b.jsx)("h2",{children:"Posts are loading..."}):Object(b.jsx)(D.a,{children:r&&r.map((function(e){return Object(b.jsx)(q.a.Column,{style:{marginBottom:"1.2rem"},children:Object(b.jsx)(re,{post:e})},e.id)}))})})]})};var ie=function(e){var t=e.errValue;return Object(b.jsx)("div",{className:"ui error message",children:Object(b.jsx)("ul",{className:"list",children:Object(b.jsx)("li",{children:t})})})};var je=function(){var e=P().login,t=Object(r.useState)(""),n=Object(j.a)(t,2),a=n[0],s=n[1],o=Object(r.useState)(""),i=Object(j.a)(o,2),l=i[0],u=i[1],d=Object(r.useState)({}),O=Object(j.a)(d,2),m=O[0],p=O[1],h=Object(A.g)(),x=Object(c.useMutation)(V,{update:function(t,n){var r=n.data.userLogin;e(r),h.push("/")},onError:function(e){p(e.graphQLErrors[0].extensions.errors)},variables:{userName:a,password:l}}),g=Object(j.a)(x,2),f=g[0],v=g[1].loading;return Object(b.jsxs)("div",{className:"form",children:[Object(b.jsxs)(se.a,{onSubmit:function(e){e.preventDefault(),f()},className:v?"loading":"",children:[Object(b.jsx)("h1",{children:"Login"}),Object(b.jsx)(se.a.Input,{label:"Username",type:"text",value:a,onChange:function(e){return s(e.target.value)},error:!!m.userName,placeholder:"Enter Username"}),Object(b.jsx)(se.a.Input,{label:"Password",type:"password",value:l,onChange:function(e){return u(e.target.value)},error:!!m.password,placeholder:"Enter Password"}),Object(b.jsx)(z.a,{type:"submit",color:"pink",children:"Login"})]}),Object.keys(m)&&Object.values(m).map((function(e){return Object(b.jsx)(ie,{errValue:e},e)}))]})};var le=function(){var e=P().login,t=Object(r.useState)(""),n=Object(j.a)(t,2),a=n[0],s=n[1],o=Object(r.useState)(""),i=Object(j.a)(o,2),l=i[0],u=i[1],d=Object(r.useState)(""),O=Object(j.a)(d,2),m=O[0],p=O[1],h=Object(r.useState)(""),x=Object(j.a)(h,2),g=x[0],f=x[1],v=Object(r.useState)({}),I=Object(j.a)(v,2),y=I[0],C=I[1],N=Object(A.g)(),k=Object(c.useMutation)(F,{update:function(t,n){var r=n.data.userLogin;e(r),N.push("/")},onError:function(e){C(e.graphQLErrors[0].extensions.errors)},variables:{userName:a,email:l,password:m,confirmPassword:g}}),w=Object(j.a)(k,2),S=w[0],$=w[1].loading;return Object(b.jsxs)("div",{className:"form",children:[Object(b.jsxs)(se.a,{onSubmit:function(e){e.preventDefault(),S()},className:$?"loading":"",children:[Object(b.jsx)("h1",{children:"Register"}),Object(b.jsx)(se.a.Input,{label:"Username",type:"text",value:a,onChange:function(e){return s(e.target.value)},error:!!y.userName,placeholder:"Enter Username"}),Object(b.jsx)(se.a.Input,{label:"Email",type:"email",value:l,onChange:function(e){return u(e.target.value)},error:!!y.email,placeholder:"Enter Email"}),Object(b.jsx)(se.a.Input,{label:"Password",type:"password",value:m,onChange:function(e){return p(e.target.value)},error:!!y.password,placeholder:"Enter Password"}),Object(b.jsx)(se.a.Input,{label:"Confirm Password",type:"password",value:g,onChange:function(e){return f(e.target.value)},error:!!y.confirmPassword,placeholder:"Confirm Password"}),Object(b.jsx)(z.a,{type:"submit",color:"pink",children:"Register"})]}),Object.keys(y)&&Object.values(y).map((function(e){return Object(b.jsx)(ie,{errValue:e},e)}))]})},ue=n(254),be=function(){var e=P(),t=e.user,n=e.logout;return t?Object(b.jsxs)(ue.a,{pointing:!0,secondary:!0,size:"massive",color:"teal",children:[Object(b.jsx)(ue.a.Item,{name:t.userName,as:o.c,to:"/",exact:!0}),Object(b.jsx)(ue.a.Menu,{position:"right",children:Object(b.jsx)(ue.a.Item,{name:"logout",as:z.a,size:"huge",onClick:function(){return n()}})})]}):Object(b.jsxs)(ue.a,{pointing:!0,secondary:!0,size:"massive",color:"pink",children:[Object(b.jsx)(ue.a.Item,{name:"Home",as:o.c,to:"/",exact:!0}),Object(b.jsxs)(ue.a.Menu,{position:"right",children:[Object(b.jsx)(ue.a.Item,{name:"Login",as:o.c,to:"/login"}),Object(b.jsx)(ue.a.Item,{name:"Register",as:o.c,to:"/register"})]})]})};function de(e){var t=e.postId,n=Object(r.useState)(""),a=Object(j.a)(n,2),s=a[0],o=a[1],i=Object(r.useState)(""),l=Object(j.a)(i,2),u=l[0],d=l[1],O=Object(r.useRef)(),m=Object(c.useMutation)(Z,{variables:{postId:t,body:s},onError:function(e){d(e.graphQLErrors[0].message)}}),p=Object(j.a)(m,1)[0];return Object(b.jsx)(R.a,{fluid:!0,children:Object(b.jsxs)(R.a.Content,{children:[Object(b.jsxs)(se.a,{onSubmit:function(e){e.preventDefault(),p(),o(""),O.current.blur()},children:[Object(b.jsx)("h4",{children:"Create a Comment"}),Object(b.jsxs)("div",{className:"ui action input fluid",children:[Object(b.jsx)("input",{placeholder:"Comment...",type:"text",value:s,onChange:function(e){return o(e.target.value)},ref:O}),Object(b.jsx)("button",{className:"ui button pink",type:"submit",disabled:!s,children:"Comment"})]})]}),u&&Object(b.jsx)("div",{className:"ui error message",style:{padding:".4rem 1.2rem"},children:Object(b.jsx)("ul",{className:"list",children:Object(b.jsx)("li",{children:u})})})]})})}function Oe(e){var t=e.comment,n=e.user,r=e.postId,a=t.userName,s=t.body,c=t.createdAt,o=t.id;return Object(b.jsx)(R.a,{fluid:!0,children:Object(b.jsxs)(R.a.Content,{children:[n&&n.userName===a&&Object(b.jsx)(ne,{postId:r,commentId:o}),Object(b.jsx)(R.a.Header,{children:a}),Object(b.jsx)(R.a.Meta,{children:Q()(c).fromNow()}),Object(b.jsx)(R.a.Description,{children:s})]})})}var me=function(){var e=P().user,t=Object(A.h)().postId,n=Object(c.useQuery)(W,{variables:{postId:t}}).data,r=(n=void 0===n?{}:n).getPost,a=Object(A.g)();if(r){var s=r.id,o=r.body,i=r.createdAt,j=r.userName,l=r.comments,u=r.likes,d=r.commentCount,O=r.likeCount;return Object(b.jsx)(q.a,{children:Object(b.jsxs)(q.a.Row,{children:[Object(b.jsx)(q.a.Column,{width:2,children:Object(b.jsx)(U.a,{floated:"right",size:"small",src:"https://react.semantic-ui.com/images/avatar/large/molly.png"})}),Object(b.jsxs)(q.a.Column,{width:10,children:[Object(b.jsxs)(R.a,{fluid:!0,children:[Object(b.jsxs)(R.a.Content,{children:[Object(b.jsx)(R.a.Header,{children:j}),Object(b.jsx)(R.a.Meta,{children:Q()(i).fromNow()}),Object(b.jsx)(R.a.Description,{children:o})]}),Object(b.jsx)("hr",{}),Object(b.jsxs)(R.a.Content,{extra:!0,children:[Object(b.jsx)(ee,{user:e,post:{id:s,likes:u,likeCount:O}}),Object(b.jsxs)(z.a,{as:"div",labelPosition:"right",onClick:function(){},children:[Object(b.jsx)(z.a,{basic:!0,color:"teal",children:Object(b.jsx)(T.a,{name:"comments"})}),Object(b.jsx)(G.a,{basic:!0,color:"teal",pointing:"left",children:d})]}),e&&e.userName===j&&Object(b.jsx)(ne,{postId:s,cb:function(){a.push("/")}})]})]}),e&&Object(b.jsx)(de,{postId:s}),l.map((function(t){return Object(b.jsx)(Oe,{comment:t,user:e,postId:s},t.id)}))]})]})})}return Object(b.jsx)("p",{children:"Loading..."})},pe=(n(233),n(208));var he=function(e){var t=e.component,n=Object(pe.a)(e,["component"]),r=P().user;return Object(b.jsx)(A.b,Object(l.a)(Object(l.a)({},n),{},{render:function(e){return r?Object(b.jsx)(A.a,{to:"/"}):Object(b.jsx)(t,Object(l.a)({},e))}}))};var xe=function(){return Object(b.jsxs)(L.a,{children:[Object(b.jsx)(be,{}),Object(b.jsxs)(A.d,{children:[Object(b.jsx)(A.b,{path:"/",exact:!0,component:oe}),Object(b.jsx)(A.b,{path:"/posts/:postId",component:me}),Object(b.jsx)(he,{path:"/register",component:le}),Object(b.jsx)(he,{path:"/login",component:je})]})]})},ge=(n(234),Object(c.createHttpLink)({uri:"https://social-net-server.herokuapp.com/"})),fe=Object(i.a)((function(){var e=localStorage.getItem("MEGNET_CHAT_TOKEN");return{headers:{Authorization:e?"Bearer ".concat(e):""}}})),ve=new c.ApolloClient({link:fe.concat(ge),cache:new c.InMemoryCache});s.a.render(Object(b.jsx)(c.ApolloProvider,{client:ve,children:Object(b.jsx)(E,{children:Object(b.jsx)(o.a,{children:Object(b.jsx)(xe,{})})})}),document.getElementById("root"))}},[[235,1,2]]]);
//# sourceMappingURL=main.fd257c6c.chunk.js.map